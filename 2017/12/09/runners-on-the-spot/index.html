<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous"/><style data-href="/commons.131b48b25a50eff60b34.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.15.19"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><style data-styled="hTmxqc lcZENV lfoWPa hPmQYh dANmgz brBAvj hpDnww bWPqAN gEMFDS eyJpws cmRrYK hwkicN iTdcdb jRHVYT kQWgFX itRnbT jNHeyA hFicPH" data-styled-version="4.3.2">
/* sc-component-id: SideMenu__StyledBurgerMenu-uekpe8-0 */
.hTmxqc .bm-burger-button{position:fixed;width:36px;height:30px;left:36px;top:36px;} .hTmxqc .bm-burger-bars{background:#ffffff;} .hTmxqc .bm-cross-button{height:24px;width:24px;} .hTmxqc .bm-cross{background:#ffffff;} .hTmxqc .bm-menu{background:rgb(0,0,0,0.5);padding:2.5em 1em 0;font-size:1.15em;} .hTmxqc .bm-morph-shape{fill:#373a47;} .hTmxqc .bm-item-list{padding-top:2em;} .hTmxqc .bm-item{display:inline-block;padding:0.5em;} .hTmxqc .bm-overlay{background:rgba(0,0,0,0.3);}
/* sc-component-id: SideMenu__MenuLink-uekpe8-1 */
.lcZENV{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#fff;border:0;margin:0;margin-right:0.5rem;padding-left:20px;padding-right:20px;min-width:42px;z-index:10;}
/* sc-component-id: Footer__FooterWrapper-sc-1oxe0wr-0 */
.hFicPH{text-align:left;padding-top:30px;padding-bottom:50px;background-color:rgba(32,35,42,0.85);color:#ffffff;padding-left:20px;padding-right:20px;margin:3.5em auto 0 0;} .hFicPH nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;max-width:900px;margin:0 auto;} .hFicPH nav .footer-col{-webkit-flex:1 auto;-ms-flex:1 auto;flex:1 auto;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-bottom:1em;padding-right:1em;} .hFicPH a{color:#ffffff;font-weight:bold;} .hFicPH a:hover{color:#e8e8e8;border-bottom:1px dotted #e8e8e8;} .hFicPH .footer-col > p{margin:0;} .hFicPH .footer-title{margin:0 0 1rem;} .hFicPH .footer-item{padding:0.25rem 0;color:#ffffff;} .hFicPH .footer-heart{color:red;} .hFicPH .footer-item-text{padding:0.1rem 0;color:#ffffff;} .hFicPH .footer-header{-webkit-order:1;-ms-flex-order:1;order:1;margin:0 0.25rem;margin-right:0.25rem;padding:0.25rem;} @media (max-width:564px){.hFicPH .footer-col:first-child{width:100%;}}
/* sc-component-id: sc-global-3886539976 */
*{box-sizing:border-box;margin:0;padding:0;} body{font-family:"Lato",sans-serif;color:#222222cc;background-color:#e8e8e8;} img{max-width:100%;height:auto;vertical-align:middle;border:0;} a{-webkit-text-decoration:none;text-decoration:none;color:rgba(34,34,34,0.8);} ul,ol{padding-left:2em;margin:1em 0 0 0;}
/* sc-component-id: Wrapper-aej7i5-0 */
.hwkicN{position:relative;border-radius:3px;width:80%;max-width:770px;border-bottom:1px solid #ebf2f6;word-wrap:break-word;background-color:#fff;margin:0px auto 30px auto;top:30px;padding:50px;box-shadow:0 0 0 0,0 6px 12px rgba(0,0,0,0.1);} @media (max-width:780px){.hwkicN{width:90%;padding:25px;}}
/* sc-component-id: Hero__HeroContainer-sc-1i1rqpz-0 */
.lfoWPa{position:relative;display:table;width:100%;height:340px;overflow:hidden;background-repeat:no-repeat;background-position:center;background-size:cover;}
/* sc-component-id: Hero__TitleContainer-sc-1i1rqpz-1 */
.hPmQYh{display:table-cell;vertical-align:middle;text-align:center;width:100%;}
/* sc-component-id: Hero__LocationContainer-sc-1i1rqpz-2 */
.gEMFDS{display:table-footer-group;vertical-align:center;text-align:right;width:100%;}
/* sc-component-id: Hero__HeroTitle-sc-1i1rqpz-3 */
.dANmgz{font-size:3.5rem;margin:10px 60px;color:#fff;text-shadow:2px 2px #222222;font-weight:800;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}
/* sc-component-id: Hero__HeroSubtitle-sc-1i1rqpz-4 */
.brBAvj{font-size:1.7rem;margin:10px 60px;color:#fff;text-shadow:2px 2px #222222;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}
/* sc-component-id: Hero__DateAndAuthor-sc-1i1rqpz-5 */
.hpDnww{font-weight:500;font-size:1.2rem;color:#fff;text-shadow:2px 2px #222222;}
/* sc-component-id: Hero__AuthorLink-sc-1i1rqpz-6 */
.bWPqAN{margin-left:0.3rem;font-weight:500;font-size:1.2rem;color:#fff;text-shadow:2px 2px #222222;} .bWPqAN:hover{border-bottom:1px dotted #787676;} .bWPqAN:before{content:'@';}
/* sc-component-id: Hero__LocationLink-sc-1i1rqpz-7 */
.cmRrYK{margin-right:0.7rem;font-size:0.9rem;color:#fff;text-shadow:2px 2px #222222;font-size:1rem;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;font-style:italic;} .cmRrYK:hover{border-bottom:1px dotted #787676;}
/* sc-component-id: Hero__LocationMarker-sc-1i1rqpz-8 */
.eyJpws{margin-right:0.4rem;font-size:0.75rem;color:#fff;text-shadow:2px 2px #222222;font-family:'Open Sans','Helvetica Neue',Helvetica,Arial,sans-serif;}
/* sc-component-id: TagList__ListContainer-sc-1uj42o2-0 */
.kQWgFX{display:inline;margin:0 0.5rem 0 0;color:#787676;}
/* sc-component-id: TagList__TagListItem-sc-1uj42o2-1 */
.itRnbT{margin-left:0.3rem;display:inline-block;min-width:10px;padding:3px 7px;font-size:12px;font-weight:700;line-height:1;color:#fff;text-align:center;white-space:nowrap;vertical-align:middle;background-color:#777;border-radius:10px;} .itRnbT:hover{border-bottom:1px dotted #787676;}
/* sc-component-id: ContentHeader__Header-sc-1uw779c-0 */
.jRHVYT{margin-bottom:2rem;color:#787676;}
/* sc-component-id: Content__ContentBody-sc-1jppj8x-0 */
.jNHeyA{line-height:1.6;} .jNHeyA > *:first-child{padding-top:0;margin-top:0;} .jNHeyA > h1{margin-top:3rem;font-size:2em;} .jNHeyA > h2{margin-top:3rem;font-size:1.5em;} .jNHeyA > h3{padding-top:3rem;font-size:1.17em;} .jNHeyA > p{margin:1em 0 0 0;} .jNHeyA a{border-bottom:1px dotted rgba(162,162,162,0.8);} .jNHeyA a:hover{border-bottom-style:solid;} .jNHeyA a.anchor,.jNHeyA a.gatsby-resp-image-link{border:none;} .jNHeyA > blockquote{box-sizing:border-box;margin:1.75em 0 1.75em -2.2em;padding:0 0 0 1.75em;border-left:0.4em solid rgba(32,35,42,0.85);} .jNHeyA > blockquote p{margin:0.8em 0;font-style:italic;} .jNHeyA .gatsby-highlight{border-radius:5px;font-size:15px;line-height:1.7;background:#2d2d2d;color:#ffffff;border-radius:10px;overflow:auto;tab-size:1.5em;margin:1.5em 0em 1.5em 0;font-size:0.7em;} .jNHeyA .gatsby-highlight > pre{border:0;margin:0;padding:1;} .jNHeyA .gatsby-highlight-code-line{background-color:#022a4b;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:0.75em;border-left:0.25em solid #ffa7c4;} .jNHeyA p > code.language-text,.jNHeyA li > code.language-text{background:rgba(255,229,100,0.2);color:#222222cc;padding:0 3px;font-size:0.94em;border-radius:0.3rem;} .jNHeyA table{margin-top:1em;border-collapse:collapse;border-radius:0.5em;overflow:hidden;} .jNHeyA table th,.jNHeyA table td{padding:0.5em;background:#e8e8e8;border-bottom:2px solid white;} .jNHeyA:not(pre) a code[class*='language-']{color:#222222cc;background-color:rgba(255,229,100,0.2);}
/* sc-component-id: Article__ArticleWrapper-sc-1nyoqfc-0 */
.iTdcdb{padding:0 30px 30px;} @media only screen and (max-width:500px){.iTdcdb{padding:0;}}</style><title data-react-helmet="true">Runners on the Spot | 040code</title><link data-react-helmet="true" rel="stylesheet" type="text/css" href="/asciinema-player.css"/><link data-react-helmet="true" rel="canonical" href="https://040code.github.io/2017/12/09/runners-on-the-spot"/><meta data-react-helmet="true" name="description" content="Introduction GitLab CI is a first class citizen in GitLab to enable continuous integration and delivery to your project. Builds are‚Ä¶"/><meta data-react-helmet="true" property="og:url" content="https://040code.github.io/2017/12/09/runners-on-the-spot"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Runners on the Spot | 040code"/><meta data-react-helmet="true" property="og:description" content="Introduction GitLab CI is a first class citizen in GitLab to enable continuous integration and delivery to your project. Builds are‚Ä¶"/><meta data-react-helmet="true" property="og:image" content="https://040code.github.io/static/2017-12-09-runners-on-the-spot-fb-b1bbbf8f054dbb6905be8c32e83a5735.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="niekos77"/><meta data-react-helmet="true" name="twitter:title" content="Runners on the Spot | 040code"/><meta data-react-helmet="true" name="twitter:description" content="Introduction GitLab CI is a first class citizen in GitLab to enable continuous integration and delivery to your project. Builds are‚Ä¶"/><meta data-react-helmet="true" name="twitter:image" content="https://040code.github.io/static/2017-12-09-runners-on-the-spot-tw-6722873f2d4ed28f373d12d84d49ddad.png"/><script data-react-helmet="true" src="/asciinema-player.js"></script><link rel="shortcut icon" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#222222"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=008654519ce705ac7bc44303a9014606"/><link as="script" rel="preload" href="/app-5643697e2de9bcce0385.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-658161403c49a8a1208a.js"/><link as="script" rel="preload" href="/commons-f34b6b8f007fce409bd2.js"/><link as="script" rel="preload" href="/webpack-runtime-13449825e32741877b57.js"/><link as="fetch" rel="preload" href="/page-data/2017/12/09/runners-on-the-spot/page-data.json" crossorigin="anonymous"/></head><body><noscript>This site runs best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="SideMenu__StyledBurgerMenu-uekpe8-0 hTmxqc"><div><div class="bm-overlay" style="position:fixed;z-index:1000;width:100%;height:100%;background:rgba(0, 0, 0, 0.3);opacity:0;-moz-transform:translate3d(100%, 0, 0);-ms-transform:translate3d(100%, 0, 0);-o-transform:translate3d(100%, 0, 0);-webkit-transform:translate3d(100%, 0, 0);transform:translate3d(100%, 0, 0);transition:opacity 0.3s, transform 0s 0.3s"></div><div id="" class="bm-menu-wrap" style="position:fixed;right:inherit;z-index:1100;width:300px;height:100%;-moz-transform:translate3d(-100%, 0, 0);-ms-transform:translate3d(-100%, 0, 0);-o-transform:translate3d(-100%, 0, 0);-webkit-transform:translate3d(-100%, 0, 0);transform:translate3d(-100%, 0, 0);transition:all 0.5s"><div class="bm-menu" style="height:100%;box-sizing:border-box;overflow:auto"><nav class="bm-item-list" style="height:100%"><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/">üè° 040 blog</a><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/about">About</a><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/authors/niek">Niek Palm</a><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/authors/maarten">Maarten Metz</a><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/authors/jeroen">Jeroen Knoops</a><a class="bm-item SideMenu__MenuLink-uekpe8-1 lcZENV" style="display:block" tabindex="-1" href="/authors/stefan">Stefan van den Oord</a></nav></div><div><div class="bm-cross-button" style="position:absolute;width:24px;height:24px;right:8px;top:8px"><span style="position:absolute;top:6px;right:14px"><span class="bm-cross" style="position:absolute;width:3px;height:14px;transform:rotate(45deg)"></span><span class="bm-cross" style="position:absolute;width:3px;height:14px;transform:rotate(-45deg)"></span></span><button style="position:absolute;left:0;top:0;width:100%;height:100%;margin:0;padding:0;border:none;font-size:0;background:transparent;cursor:pointer" tabindex="-1">Close Menu</button></div></div></div><div><div class="bm-burger-button" style="z-index:1000"><span><span class="bm-burger-bars" style="position:absolute;height:20%;left:0;right:0;top:0%;opacity:1"></span><span class="bm-burger-bars" style="position:absolute;height:20%;left:0;right:0;top:40%;opacity:1"></span><span class="bm-burger-bars" style="position:absolute;height:20%;left:0;right:0;top:80%;opacity:1"></span></span><button style="position:absolute;left:0;top:0;width:100%;height:100%;margin:0;padding:0;border:none;font-size:0;background:transparent;cursor:pointer">Open Menu</button></div></div></div></div><div style="margin:0 0"><div style="background-image:url(&quot;/static/blob_glow-fbdbbca72604c9ad67cb9e4af73dcbce.jpg&quot;)" class="Hero__HeroContainer-sc-1i1rqpz-0 lfoWPa"><div class="Hero__TitleContainer-sc-1i1rqpz-1 hPmQYh"><h1 class="Hero__HeroTitle-sc-1i1rqpz-3 dANmgz">Runners on the Spot</h1><h2 class="Hero__HeroSubtitle-sc-1i1rqpz-4 brBAvj">Auto scaling GitLab runners on AWS with Terraform</h2><span class="Hero__DateAndAuthor-sc-1i1rqpz-5 hpDnww">by:<!-- --> <a class="Hero__AuthorLink-sc-1i1rqpz-6 bWPqAN" href="/authors/niek">niek</a>¬† on <!-- -->2017-12-09</span></div><div class="Hero__LocationContainer-sc-1i1rqpz-2 gEMFDS"><span class="Hero__LocationMarker-sc-1i1rqpz-8 eyJpws"><span class="fa fa-map-marker-alt"></span></span><a href="https://goo.gl/maps/xSdR9b5xnzu" target="_blank" class="Hero__LocationLink-sc-1i1rqpz-7 cmRrYK">Blob</a></div></div><main role="main" class="Wrapper-aej7i5-0 hwkicN"><article class="Article__ArticleWrapper-sc-1nyoqfc-0 iTdcdb"><section><header class="ContentHeader__Header-sc-1uw779c-0 jRHVYT"><div class="TagList__ListContainer-sc-1uj42o2-0 kQWgFX"><a class="w3-round-size TagList__TagListItem-sc-1uj42o2-1 itRnbT" href="/tags/gitlab">gitlab</a> <a class="w3-round-size TagList__TagListItem-sc-1uj42o2-1 itRnbT" href="/tags/docker">docker</a> <a class="w3-round-size TagList__TagListItem-sc-1uj42o2-1 itRnbT" href="/tags/aws">aws</a> <a class="w3-round-size TagList__TagListItem-sc-1uj42o2-1 itRnbT" href="/tags/terraform">terraform</a></div></header><div class="Content__ContentBody-sc-1jppj8x-0 jNHeyA"><h2 id="introduction"><a href="#introduction" aria-label="introduction permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p><a href="https://about.gitlab.com/features/gitlab-ci-cd/">GitLab CI</a> is a first class citizen in GitLab to enable continuous integration and delivery to your project. Builds are orchestrated via <a href="https://docs.gitlab.com/runner/">GitLab Runners</a>, which are agents registered to your GitLab account. An agent runs builds using a local shell or a container. Runnings these builds requires a well-defined infrastructure, both with respect to the type of server and the server capacity. Would it not be great if you can scale the infrastructure based on your needs? Indeed, GitLabs runner supports out of the box auto scaling using docker machine, which is discussed in the GitLab blog article: <a href="https://about.gitlab.com/2017/11/23/autoscale-ci-runners/">Autoscale GitLab CI runners and save 90% on EC2 costs</a>.</p>
<p>The GitLab blog article nicely explains how to create your infrastructure in a manual way. However, we rather automate all things. Thus, we will automate the set up described in the blog article. In this post I will discuss how to create the infrastructure needed to run the build on AWS spot instances with <a href="https://www.terraform.io/">Hashicorp Terraform</a>. The GitLab Runner module discussed in the post is available in the <a href="https://registry.terraform.io/modules/npalm/gitlab-runner/aws/0.1.0">Terraform Registery</a>.</p>
<a href="#">
    <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 42.07650273224044%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABVElEQVQY001RS1KDQBTkGt7HhVfyHF7BhTtX2ZmyKvuoVYGEgDPABDAQ5RMKGIb52GAlZS+GrvfmTXc/rL7vOe/tzWa9Xn+lqRgnKKW6rhuGgXMuhDifz7ZtM3YAR4UPUwfcwrAxxnGc1WqVZRk4uhhGXWsNgrNpmuXyxfN9dJWSZipPFyxcNf8gpcSTOKGcZxkhBDxJYkpoxFgUUP+Q75PaaAkDFh9H09bd8yN/++gXT8qYYfbVtq2aAeUgoO5uRym+xKUJTQqIQxXKozHN+HBX3d6Y13sMV2VZFD/A6fRd1xU8B0GwdZxPQrz9zvYTklSX4TmzblK1WRgzKqlhGI2iKLbOlkXR8XiM45jMoJSEYeSF6TDjklnra2ZUsfA8zyFeliW2yBhzXRexw4B6lL2TEj/ozzaftiqlGgUSCjFiYRhGvYbpqrqGn7tCDIPWEhwXfgFUEL7p2geODAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;"></span>
  <picture>
        <source srcset="/static/fd91ecffb8159f85b66f5b526bb498f5/cc182/gitlab-runner.webp 148w,
/static/fd91ecffb8159f85b66f5b526bb498f5/f7e40/gitlab-runner.webp 295w,
/static/fd91ecffb8159f85b66f5b526bb498f5/1a2f4/gitlab-runner.webp 590w,
/static/fd91ecffb8159f85b66f5b526bb498f5/7dd13/gitlab-runner.webp 732w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp">
        <source srcset="/static/fd91ecffb8159f85b66f5b526bb498f5/cf440/gitlab-runner.png 148w,
/static/fd91ecffb8159f85b66f5b526bb498f5/d2d38/gitlab-runner.png 295w,
/static/fd91ecffb8159f85b66f5b526bb498f5/b9e4f/gitlab-runner.png 590w,
/static/fd91ecffb8159f85b66f5b526bb498f5/7ec06/gitlab-runner.png 732w" sizes="(max-width: 590px) 100vw, 590px" type="image/png">
        <img class="gatsby-resp-image-image" src="/static/fd91ecffb8159f85b66f5b526bb498f5/b9e4f/gitlab-runner.png" alt="GitLab Runner" title="GitLab Runner" loading="lazy">
      </picture>
    </span>
</a>
<h2 id="prerequisites"><a href="#prerequisites" aria-label="prerequisites permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h2>
<p>Before we start, we need to briefly discuss the GitLab runners. To execute the builds, GitLab uses an agent to orchestrate the build with a docker machine. A docker machine creates instances with docker engine to run docker containers. The first step for setting up a runner is to register a new runner. Because GitLab currently does not provide a fully automated way for this, we will do this manually.</p>
<p>Open you GitLab project and lookup the token to register a runner. Be aware that there are project tokens and a GitLab global token. Next, we use a docker container to register a runner. The command will ask a few details.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">docker run -it --rm gitlab/gitlab-runner register</code></pre></div>
<p><asciinema-player src="/2017/12/09/runners-on-the-spot/register.json"
  cols="166" rows="15" autoplay="true" loop="true" speed="1.5">
</asciinema-player></p>
<p>Provide the requested details and consult the GitLab manual for more details. Once done, you should see a new runner registered at your project or globally. Open the runner settings in edit mode and record the token. This token is needed later for connecting the agent.</p>
<h2 id="creating-infrastructure-for-the-runners"><a href="#creating-infrastructure-for-the-runners" aria-label="creating infrastructure for the runners permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating infrastructure for the runners</h2>
<p>Now the runner is configured in GitLab, we can start creating the infrastructure on AWS. For setting up the network layers, we use <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html">Amazon networking scenario 2</a> to build a VPC with a public and private subnets. For more details see this <a href="2017/06/18/terraform-aws-vpc/">post</a> about creating a VPC in terraform. You can also simply use the <a href="https://registry.terraform.io/modules/terraform-aws-modules/vpc/aws/1.7.0">official terraform module</a>.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">module &quot;vpc&quot; {
  source  = &quot;terraform-aws-modules/vpc/aws&quot;
  version = &quot;1.5.1&quot;

  name = &quot;vpc-${var.environment}&quot;
  cidr = &quot;10.0.0.0/16&quot;

  azs             = [&quot;eu-west-1a&quot;, &quot;eu-west-1b&quot;, &quot;eu-west-1c&quot;]
  private_subnets = [&quot;10.0.1.0/24&quot;, &quot;10.0.2.0/24&quot;, &quot;10.0.3.0/24&quot;]
  public_subnets  = [&quot;10.0.101.0/24&quot;, &quot;10.0.102.0/24&quot;, &quot;10.0.103.0/24&quot;]

  enable_nat_gateway = true

  tags = {
    Environment = &quot;${var.environment}&quot;
  }
}</code></pre></div>
<p>Next, we create a <code class="language-text">t2.micro</code> instance using an autoscaling group in the private network. On this instance we install and configure the GitLab runner. Configuration of GitLab runners is done via the <code class="language-text">config.toml</code> file. Below the parameterized version of this configuration file. In the Terraform module you will find that the configuration file is loaded via a data template.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">concurrent = ${runner_concurrent}
check_interval = 0

[[runners]]
  name = &quot;${runners_name}&quot;
  url = &quot;${gitlab_url}&quot;
  token = &quot;${runners_token}&quot;
  executor = &quot;docker+machine&quot;
  limit = ${runners_limit}
  [runners.docker]
    tls_verify = false
    image = &quot;docker:17.11.0-ce&quot;
    privileged = ${runners_privilled}
    disable_cache = false
    volumes = [&quot;/cache&quot;]
    shm_size = 0
  [runners.cache]
    Type = &quot;s3&quot;
    ServerAddress = &quot;s3-${aws_region}.amazonaws.com&quot;
    AccessKey = &quot;${bucket_user_access_key}&quot;
    SecretKey = &quot;${bucket_user_secret_key}&quot;
    BucketName = &quot;${bucket_name}&quot;
    Insecure = false
  [runners.machine]
    IdleCount = ${runners_idle_count}
    IdleTime = ${runners_idle_time}
    MachineDriver = &quot;amazonec2&quot;
    MachineName = &quot;runner-%s&quot;
    MachineOptions = [
      &quot;amazonec2-access-key=${access_key}&quot;,
      &quot;amazonec2-secret-key=${secret_key}&quot;,
      &quot;amazonec2-instance-type=${instance_type}&quot;,
      &quot;amazonec2-region=${aws_region}&quot;,
      &quot;amazonec2-vpc-id=${vpc_id}&quot;,
      &quot;amazonec2-subnet-id=${subnet_id}&quot;,
      &quot;amazonec2-private-address-only=true&quot;,
      &quot;amazonec2-request-spot-instance=true&quot;,
      &quot;amazonec2-spot-price=${spot_price_bid}&quot;,
      &quot;amazonec2-security-group=${security_group_name}&quot;
    ]</code></pre></div>
<p>All variables can be configured and most of them have default values. Only the name of the runner, the token and the GitLab URL need to be configured. The configuration contains a shared cache in S3 which will expire at the end of the next day (after creation) by default. Files will be deleted via S3 lifecycle management once expired, but the number of expiration days can be changed to your needs. You can find all the available variables in the <code class="language-text">variables.tf</code> file of the module. Next we add the module to our Terraform file and define a minimal set of variables.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">module &quot;gitlab-runner&quot; {
  source = &quot;npalm/gitlab-runner/aws&quot;

  aws_region     = &quot;&lt;region-to-use&gt;&quot;
  environment    = &quot;ci-runners&quot;
  ssh_public_key = &quot;&lt;contains-public-key&quot;

  vpc_id                  = &quot;${module.vpc.vpc_id}&quot;
  subnet_id_gitlab_runner = &quot;${element(module.vpc.private_subnets, 0)}&quot;
  subnet_id_runners       = &quot;${element(module.vpc.private_subnets, 0)}&quot;

  # Values below are created during the registration process of the runner.
  runner_name       = &quot;&lt;name-of-the-runner&quot;
  runner_gitlab_url = &quot;&lt;gitlab-url&gt;&quot;
  runner_token      = &quot;&lt;token-of-the-runner&quot;
}</code></pre></div>
<p>The complete example is in <a href="https://github.com/npalm/terraform-aws-gitlab-runner/tree/master/example">GitHub</a>. Now it is time to execute the scripts to create the actual infrastructure. Be aware that you need to configure AWS keys and have Terraform installed. The steps below should guide you through the setup.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">git clone https://github.com/npalm/terraform-aws-gitlab-runner.git
cd tf-aws-gitlab-runner/example</code></pre></div>
<p>The example directory contains the example as described above, so the properties for your newly registered runner in GitLab need to be configured. Please register a runner in GitLab (see docker command above) and update the <code class="language-text">terraform.tfvars</code> file. That is all, now execute the Terraform code.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># genere SSH key pair
./init.sh

# initialize terraform
terraform init

# apply, or plan first
terraform apply</code></pre></div>
<p><asciinema-player src="/2017/12/09/runners-on-the-spot/terraform.json"
  cols="166" rows="15" autoplay="true" loop="true" speed="1.5">
</asciinema-player></p>
<p>After a few minutes the runner should be running and you should see it in your AWS console.
<a href="#">
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 15.377358490566037%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAlUlEQVQI1zWNOw7CMBBEc3lqLsApqCg5AS3ExrGytuMP/sWiSJHYbJDyqnm7Gk13uavzbTxd+ePtviUBiFJKa63W2g4qWtt1Xddt25Zlmec5hNBZ56RU2lhzgFfsxxgxpJS893EHYzTaAABjrO97Kacu58z5YK0tf/BHCEHlnGutlVKUUvexr+EphQQ1UkpwQAjwfvoB56ij6wuRaagAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;"></span>
  <picture>
        <source srcset="/static/da22dc7ce8a7f28e3d3a087312726989/cc182/ec2.webp 148w,
/static/da22dc7ce8a7f28e3d3a087312726989/f7e40/ec2.webp 295w,
/static/da22dc7ce8a7f28e3d3a087312726989/1a2f4/ec2.webp 590w,
/static/da22dc7ce8a7f28e3d3a087312726989/4837b/ec2.webp 885w,
/static/da22dc7ce8a7f28e3d3a087312726989/2f819/ec2.webp 1180w,
/static/da22dc7ce8a7f28e3d3a087312726989/2c53d/ec2.webp 2120w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp">
        <source srcset="/static/da22dc7ce8a7f28e3d3a087312726989/cf440/ec2.png 148w,
/static/da22dc7ce8a7f28e3d3a087312726989/d2d38/ec2.png 295w,
/static/da22dc7ce8a7f28e3d3a087312726989/b9e4f/ec2.png 590w,
/static/da22dc7ce8a7f28e3d3a087312726989/f9b6a/ec2.png 885w,
/static/da22dc7ce8a7f28e3d3a087312726989/2d849/ec2.png 1180w,
/static/da22dc7ce8a7f28e3d3a087312726989/6ecdf/ec2.png 2120w" sizes="(max-width: 590px) 100vw, 590px" type="image/png">
        <img class="gatsby-resp-image-image" src="/static/da22dc7ce8a7f28e3d3a087312726989/b9e4f/ec2.png" alt="Running EC2 instances" title="Running EC2 instances" loading="lazy">
      </picture>
    </span>
</a>
<br>
The runner should be active as well in GitLab. Check the runner pages which should now indicate the latest moment of contact.
<a href="#">
<span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 76.30573248407643%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABDklEQVQoz5WT3XKDIBCFef9H6kxfoulML3OXQFFAEZBfc1DHTC9M6F4o6h7Px+5CKGOc89vtTild/hlETxoy6K118V2EEJSU3vvtkVhrh2HAKqWUcy4vAzla6yONOOe6rksptnBCDLMnNsRSKSFE3/fzPOPVufECQGNdLnsOmZ2DDOaM0k38IgqIfXUuh/M0TbnuJ9afn8nWa0jl43v4/Bl3bGusMaaxNymXr2t3uXLw78561KUtUDBvdclhK3gVK6WWc+A/8KWgugdp7TNK3YgNw3HUR10JVqIXMcQW7CoexueQQMx/OeamERt9PeakYjPGjJnWb/mts5ASQ4FqV2fcYGuda9w2WouzMK/5D52sc2TxHp2fAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;"></span>
  <picture>
        <source srcset="/static/d9ff5713181f96b5c776524cd5081007/cc182/runner.webp 148w,
/static/d9ff5713181f96b5c776524cd5081007/f7e40/runner.webp 295w,
/static/d9ff5713181f96b5c776524cd5081007/1a2f4/runner.webp 590w,
/static/d9ff5713181f96b5c776524cd5081007/4837b/runner.webp 885w,
/static/d9ff5713181f96b5c776524cd5081007/2f819/runner.webp 1180w,
/static/d9ff5713181f96b5c776524cd5081007/1752f/runner.webp 1570w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp">
        <source srcset="/static/d9ff5713181f96b5c776524cd5081007/cf440/runner.png 148w,
/static/d9ff5713181f96b5c776524cd5081007/d2d38/runner.png 295w,
/static/d9ff5713181f96b5c776524cd5081007/b9e4f/runner.png 590w,
/static/d9ff5713181f96b5c776524cd5081007/f9b6a/runner.png 885w,
/static/d9ff5713181f96b5c776524cd5081007/2d849/runner.png 1180w,
/static/d9ff5713181f96b5c776524cd5081007/a0d55/runner.png 1570w" sizes="(max-width: 590px) 100vw, 590px" type="image/png">
        <img class="gatsby-resp-image-image" src="/static/d9ff5713181f96b5c776524cd5081007/b9e4f/runner.png" alt="GitLab Runner details" title="GitLab Runner details" loading="lazy">
      </picture>
    </span>
</a>
<br></p>
<p>The modules also enable CloudWatch logging, all <code class="language-text">systemd</code> logging is streamed. Go to CloudWatch to inspect the logging and you will see that the installation process was logged as well.</p>
<a href="#">
    <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 16.97401508801341%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAjUlEQVQI1zWMXQ+CMAxF+f9/z0jXjn24BxPcFDVsHbCIjcSTm5M+9N4uxsTM+76LrbWllFqr956IQgjGGDnEzjn7I+e8/Olu49haO8rGDDnPzEWeFIBMaK0BABFlAlGlFFvb1mU96K7pFZ+8bJ/CTHp4z3kudbCuB2WcV6hP514hIWlAcpdwn57pMYklX9i7o8CqzzMNAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;"></span>
  <picture>
        <source srcset="/static/1111ac4745032de3c599fdfa409cd4b1/cc182/cloudwatch.webp 148w,
/static/1111ac4745032de3c599fdfa409cd4b1/f7e40/cloudwatch.webp 295w,
/static/1111ac4745032de3c599fdfa409cd4b1/1a2f4/cloudwatch.webp 590w,
/static/1111ac4745032de3c599fdfa409cd4b1/4837b/cloudwatch.webp 885w,
/static/1111ac4745032de3c599fdfa409cd4b1/2f819/cloudwatch.webp 1180w,
/static/1111ac4745032de3c599fdfa409cd4b1/7c78f/cloudwatch.webp 2386w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp">
        <source srcset="/static/1111ac4745032de3c599fdfa409cd4b1/cf440/cloudwatch.png 148w,
/static/1111ac4745032de3c599fdfa409cd4b1/d2d38/cloudwatch.png 295w,
/static/1111ac4745032de3c599fdfa409cd4b1/b9e4f/cloudwatch.png 590w,
/static/1111ac4745032de3c599fdfa409cd4b1/f9b6a/cloudwatch.png 885w,
/static/1111ac4745032de3c599fdfa409cd4b1/2d849/cloudwatch.png 1180w,
/static/1111ac4745032de3c599fdfa409cd4b1/26fc7/cloudwatch.png 2386w" sizes="(max-width: 590px) 100vw, 590px" type="image/png">
        <img class="gatsby-resp-image-image" src="/static/1111ac4745032de3c599fdfa409cd4b1/b9e4f/cloudwatch.png" alt="CloudWatch logging" title="CloudWatch logging" loading="lazy">
      </picture>
    </span>
</a>
<h2 id="verify"><a href="#verify" aria-label="verify permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verify</h2>
<p>Finally we can verify that the runner is working properly by executing a build. The <code class="language-text">.gitlab-ci.yml</code> below is an example to verify the runner is working properly. The build contains two stages. In the first stage an ascii art image is generated, stored in a file which is cached in S3. In the second stage the file is retrieved from the build cache.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">stages:
  - build
  - verify

cache:
  key: &quot;$CI_BUILD_REF&quot;
  untracked: true

image: npalm/cowsay

build:
  stage: build

  script:
    - cowsay -f ghostbusters building &quot;$CI_BUILD_NAME&quot; @ stage &quot;$CI_BUILD_STAGE&quot; &gt; ghosts.txt

  tags:
     - docker.m3

verify:
  stage: verify

  script:
    - cat ghosts.txt

  tags:
    - docker.m3</code></pre></div>
<p>Add the file above to the GitLab repository that has the created runner attached. Once you commit the file a build should triggered. The logging of the verification step should contain the ascii art image.</p>
<a href="#">
    <span class="gatsby-resp-image-wrapper" style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;">
      <span class="gatsby-resp-image-background-image" style="padding-bottom: 47.993705743509054%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABv0lEQVQoz12R3WriQBTHk0mIHzVFE7u4sKltDb0UIdFFKFu6L+KVDyB4KZtSWiz4KIJWfQWhj9DC7o0IlSKbSaL5mDjqHrVlW/+ESeDMb35nTpjpdEopfX5+ajavm/c3t3fXhvFrF8MwGo1GvV6v1WrVarXValmWFQZ+SMjMI5ZLGMdx1ut1r/8Qi3GiGOV5xLIs8zkIIVjz+bxp4j+jyfQvpnQRhuEbPBgMEOIEIRKDxOMcx8ER3DY8zwuCAHCpVLJs5/E3fsXekoYE4Pl8vjH3elAWRRFQSZJzuVwikdgz67qOsQnB2CaEbMyTySvAnU4Hdhxns7Amk0lFUTKZzB6s6brt2KZlm7ZrO64fEOblZQLHtNvtSCT65egonU6nJAl6lWV5x3w0z9xZEJDlcknhoZQZjUZBEAAMZVVVoWf4gOYV5XjfrGlzz/V8b7FY0G2Y8XgMr263C2VJls7P1ZPTrKqeHR4eIMSibWBmOzNoYPPuwps7wwBWq1V/0PumpDJfk6nUQTzOR6MAMCz6ZC4UCr7vg/Y/jDGGgQ2Hw6ufFz8uL3StqMFk9GKxCL+m9H2bcrkMZKVSATPA4Xv+AdGoBSyConzvAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;"></span>
  <picture>
        <source srcset="/static/d4b535fa8f201439b10aa5e2ce199557/cc182/ghost.webp 148w,
/static/d4b535fa8f201439b10aa5e2ce199557/f7e40/ghost.webp 295w,
/static/d4b535fa8f201439b10aa5e2ce199557/1a2f4/ghost.webp 590w,
/static/d4b535fa8f201439b10aa5e2ce199557/4837b/ghost.webp 885w,
/static/d4b535fa8f201439b10aa5e2ce199557/2f819/ghost.webp 1180w,
/static/d4b535fa8f201439b10aa5e2ce199557/87621/ghost.webp 2542w" sizes="(max-width: 590px) 100vw, 590px" type="image/webp">
        <source srcset="/static/d4b535fa8f201439b10aa5e2ce199557/cf440/ghost.png 148w,
/static/d4b535fa8f201439b10aa5e2ce199557/d2d38/ghost.png 295w,
/static/d4b535fa8f201439b10aa5e2ce199557/b9e4f/ghost.png 590w,
/static/d4b535fa8f201439b10aa5e2ce199557/f9b6a/ghost.png 885w,
/static/d4b535fa8f201439b10aa5e2ce199557/2d849/ghost.png 1180w,
/static/d4b535fa8f201439b10aa5e2ce199557/6de9f/ghost.png 2542w" sizes="(max-width: 590px) 100vw, 590px" type="image/png">
        <img class="gatsby-resp-image-image" src="/static/d4b535fa8f201439b10aa5e2ce199557/b9e4f/ghost.png" alt="Build log" title="Build log" loading="lazy">
      </picture>
    </span>
</a>
<h2 id="warning"><a href="#warning" aria-label="warning permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Warning</h2>
<p>Be aware that prices of a spot instance can change over the time and instances can be terminated without a warning. Last black Friday prices of spot instances went up to over 2 dollar occasionally.</p></div></section></article></main></div><footer class="Footer__FooterWrapper-sc-1oxe0wr-0 hFicPH"><nav><div class="footer-col"><h5 class="footer-title">040 code ¬© 2019</h5><span class="footer-item">Build with <i></i><a class="footer-link" href="https://www.gatsbyjs.org/">Gatsby</a></span></div><div class="footer-col"><h5 class="footer-title">Blog</h5><span class="footer-item"><a class="footer-link" href="/">home</a></span><span class="footer-item"><a class="footer-link" href="/about">about</a></span></div><div class="footer-col"><h5 class="footer-title">Source</h5><span class="footer-item"><i></i><a class="footer-link" href="https://github.com/040code/">Github</a></span></div></nav></footer></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-97020149-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2017/12/09/runners-on-the-spot";window.webpackCompilationHash="95c6849230ad8a5f4f34";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-5643697e2de9bcce0385.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-c4fe219a301439484a06.js"],"component---src-templates-blog-list-template-js":["/component---src-templates-blog-list-template-js-3478508ec23c2934e4f1.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-658161403c49a8a1208a.js"],"component---src-templates-page-js":["/component---src-templates-page-js-7e7e89f412e118251bb2.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-5a23d2283ad3d5c31166.js"],"component---src-templates-authors-js":["/component---src-templates-authors-js-c6344b2044878ea20b55.js"],"component---src-pages-404-js":["/component---src-pages-404-js-97ff63f7f4b2c8c3c88f.js"]};/*]]>*/</script><script src="/webpack-runtime-13449825e32741877b57.js" async=""></script><script src="/commons-f34b6b8f007fce409bd2.js" async=""></script><script src="/component---src-templates-blog-post-js-658161403c49a8a1208a.js" async=""></script><script src="/app-5643697e2de9bcce0385.js" async=""></script></body></html>